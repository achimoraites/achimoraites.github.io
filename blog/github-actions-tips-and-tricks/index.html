<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Github actions tweaks</title><meta name="keywords" content="web development, achilles moraites,ci,productivity" data-svelte="svelte-11c4p6r"><meta name="description" content="Here there are some cool tricks you can do to improve your Github Actions" data-svelte="svelte-11c4p6r"><meta name="author" content="Achilles Moraites" data-svelte="svelte-11c4p6r"><meta property="og:image" content="https://images.pexels.com/photos/1181287/pexels-photo-1181287.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=225&amp;w=400" data-svelte="svelte-11c4p6r"><meta property="og:description" content="Here there are some cool tricks you can do to improve your Github Actions" data-svelte="svelte-11c4p6r"><meta property="og:title" content="Github actions tweaks" data-svelte="svelte-11c4p6r"><meta property="og:type" content="article" data-svelte="svelte-11c4p6r"><meta property="og:url" data-svelte="svelte-11c4p6r"><meta property="og:article:author" content="Achilles Moraites" data-svelte="svelte-11c4p6r">
		<meta property="og:article:tag" content="ci,productivity" data-svelte="svelte-11c4p6r">
		<meta property="og:article:published_time" content="Tue Jun 08 2021 21:57:00 GMT+0200" data-svelte="svelte-11c4p6r"><meta name="twitter:card" content="summary" data-svelte="svelte-11c4p6r"><meta name="twitter:site" content="@achimoraites" data-svelte="svelte-11c4p6r"><meta name="twitter:creator" content="@achimoraites" data-svelte="svelte-11c4p6r"><meta name="twitter:image" content="https://images.pexels.com/photos/1181287/pexels-photo-1181287.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=225&amp;w=400" data-svelte="svelte-11c4p6r"><link rel="preload" as="image" href="https://images.pexels.com/photos/1181287/pexels-photo-1181287.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=225&amp;w=400" data-svelte="svelte-11c4p6r">

		

		<link rel="modulepreload" href="/./app/start-d0d6d6c5.js">
		<link rel="modulepreload" href="/./app/chunks/vendor-1ec63ec4.js">
		<link rel="modulepreload" href="/./app/pages/$layout.svelte-ac4df60d.js">
		<link rel="modulepreload" href="/./app/pages/blog/github-actions-tips-and-tricks.md-716746ff.js">
		<link rel="modulepreload" href="/./app/chunks/blog-post-layout-4d242ba6.js">
		<link rel="modulepreload" href="/./app/chunks/OpenGraph-d6d3dbc2.js">
		<link rel="modulepreload" href="/./app/chunks/Tags-fbac4788.js">
		<link rel="stylesheet" href="/./app/assets/start-0826e215.css">
		<link rel="stylesheet" href="/./app/assets/pages/$layout.svelte-935c7f77.css">

		<script type="module">
			import { start } from "/./app/start-d0d6d6c5.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":"/."},
				session: (function(a,b,c,d,e,f,g,h,i){return {posts:[{author:a,date:"Tue Jun 08 2021 21:57:00 GMT+0200",excerpt:"Here there are some cool tricks you can do to improve your Github Actions",image:"https:\u002F\u002Fimages.pexels.com\u002Fphotos\u002F1181287\u002Fpexels-photo-1181287.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=225&w=400",tags:["ci",e],slug:"github-actions-tips-and-tricks",title:"Github actions tweaks",url:"https:\u002F\u002Fachimoraites.github.io\u002Fblog\u002Fgithub-actions-tips-and-tricks",uri:"\u002Fblog\u002Fgithub-actions-tips-and-tricks",filename:"github-actions-tips-and-tricks.md"},{author:a,date:"Sun May 10 2020 00:00:00 GMT+0300",excerpt:"Crafting high quality Angular apps requires to have knowledge of how to use the different types of modules to ensure readability, performance and scalability.",tags:[b,c,d],image:"https:\u002F\u002Fimages.pexels.com\u002Fphotos\u002F171198\u002Fpexels-photo-171198.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=225&w=400",slug:"angular-types-of-modules",subtitle:"Improve the scalabillity of your Angular project by using the module type pattern!",title:"Types of Modules in Angular",url:"https:\u002F\u002Fachimoraites.github.io\u002Fblog\u002Fangular-types-of-modules",uri:"\u002Fblog\u002Fangular-types-of-modules",filename:"angular-types-of-modules.md"},{author:a,date:f,excerpt:"When testing our apps there are times when we need to control things that are beyond our control, like the window object",image:"https:\u002F\u002Fimages.pexels.com\u002Fphotos\u002F5726788\u002Fpexels-photo-5726788.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=255&w=400",tags:[c,d,b,"testing"],slug:"advanced-angular-testing-using-jasmine",subtitle:g,title:"Angular Testing with Jasmine",url:"https:\u002F\u002Fachimoraites.github.io\u002Fblog\u002Fadvanced-angular-testing-using-jasmine",uri:"\u002Fblog\u002Fadvanced-angular-testing-using-jasmine",filename:"advanced-angular-testing-using-jasmine.md"},{author:a,date:f,excerpt:"Component inheritance can be useful when you have duplicated\u002Fshared code between your components.",tags:[b,c,h,d],slug:"angular-component-inheritance",subtitle:g,title:"Angular Component inheritance",url:"https:\u002F\u002Fachimoraites.github.io\u002Fblog\u002Fangular-component-inheritance",uri:"\u002Fblog\u002Fangular-component-inheritance",filename:"angular-component-inheritance.md"},{author:a,date:"Wed Jan 29 2020 00:00:00 GMT+0200",excerpt:i,image:"https:\u002F\u002Fimages.pexels.com\u002Fphotos\u002F1701206\u002Fpexels-photo-1701206.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=225&w=400",tags:[b,h,e],slug:"typescript-tips-and-tricks",subtitle:i,title:"Typescript Tips and Tricks",url:"https:\u002F\u002Fachimoraites.github.io\u002Fblog\u002Ftypescript-tips-and-tricks",uri:"\u002Fblog\u002Ftypescript-tips-and-tricks",filename:"typescript-tips-and-tricks.md"}]}}("achimoraites","typescript","angular","javascript","productivity","Fri May 08 2020 00:00:00 GMT+0300","Improve the scalabillity of your Angular project by using inheritance!","oop","Here are two Typescript tricks to make your life as a software developer easier.")),
				host: location.host,
				route: true,
				spa: false,
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/./app/pages/$layout.svelte-ac4df60d.js"),
						import("/./app/pages/blog/github-actions-tips-and-tricks.md-716746ff.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/blog/github-actions-tips-and-tricks",
						query: new URLSearchParams(""),
						params: {}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<nav class="header top-nav"><div class="header__container"><div class="brand"><a class="brand__link" href="/blog">Achilles Moraites</a></div>

<div class="burger-menu"><button id="nav-toggle" class="burger-menu__button"><svg width="12" height="12" class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button></div>

<div class="navlinks hidden-bar" id="nav-content"><ul class="navlinks__list list-reset"><li class="navlinks__list-element"><a class="navlinks__default" href="/"><span>Home</span></a>
			</li><li class="navlinks__list-element"><a class="navlinks__default" href="/blog"><span>Blog</span></a>
			</li></ul></div></div></nav>
<main class="circuit-bg svelte-1xdevn2">

<article class="blog-post"><h1 style="font-size: 3rem;">Github actions tweaks</h1>
	<div class="tags"><div class="article-tags"><a href="/blog"><span class="ci">#ci</span></a><a href="/blog"><span class="productivity">#productivity</span></a></div></div>
	<nav class="social-share float-right relative bottom-5 right-2 md:right-1 lg:right-0" arial-label="share this post"><ul class="flex flex-row"><li class="ml-4"><a arial-label="share on linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=https://achimoraites.github.io/blog/github-actions-tips-and-tricks"><img width="24" height="24" title="share on linkedin" alt="share on linkedin image" src="/images/icons/linkedin.svg"></a>
	</li><li class="ml-4"><a arial-label="share on twitter" href="https://twitter.com/intent/tweet?text=https://achimoraites.github.io/blog/github-actions-tips-and-tricks"><img width="24" height="24" title="share on twitter" alt="share on twitter image" src="/images/icons/twitter.svg"></a>
	</li></ul></nav>
	<p class="author">By <span style="font-weight: 600">achimoraites</span> <span>Jun 8, 2021</span></p>

	<img class="mt-4 mb-6" alt="Github actions tweaks" src="https://images.pexels.com/photos/1181287/pexels-photo-1181287.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=225&amp;w=400" width="800" height="450">
	<p>Here there are some cool tricks you can do to improve your Github Actions.</p>
<h2>Caching your packages</h2>
<p>How many times you have re-installed all of your packages in your actions even when no packages were changed?
This is not only time consuming but it can actually cost you more money as <strong>Github actions</strong> are charged based on the time they actually run;
you can <a href="https://github.com/pricing" rel="nofollow">have a look here</a> in case you are interested 😉</p>
<h3>How</h3>
<p>To cache our modules we will use the <a href="https://github.com/actions/cache" rel="nofollow"><code>actions/cache@v2</code></a> action</p>
<p>Here is an example of caching npm dependencies for Linux/MacOS</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cache node_modules 📦
  <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v2
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> ~/.npm
    <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> runner.os <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">-</span>node<span class="token punctuation">-</span>$<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> hashFiles('<span class="token important">**/package-lock.json')</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      $&#123;&#123; runner.os &#125;&#125;-node-</span></code></pre>
<p><strong><a href="https://github.com/achimoraites/achimoraites.github.io/blob/master/.github/workflows/deploy-gh.yaml#L24-L31" rel="nofollow">Here you can see it in a Github Action used for deploying this blog to gh-pages</a></strong> 🚀</p>
<h2>Create strings based on env variables</h2>
<p>There are times where you need to be able to create a string based on env variables.
The most common case is when you want to create a path using one or more env variables;</p>
<h3>How</h3>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> paths<span class="token punctuation">-</span>printer 🦄

<span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">BASE_URL</span><span class="token punctuation">:</span> <span class="token string">"https://example.com/"</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">print-stuff</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
	  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create paths from env variables
	    <span class="token comment"># this outputs "IMAGES_PATH: https://example.com/assets/img/"</span>
	    <span class="token key atrule">run</span><span class="token punctuation">:</span>  <span class="token key atrule">echo  "IMAGES_PATH</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>env.IMAGES_PATH<span class="token punctuation">&#125;</span>"
	    <span class="token key atrule">env</span><span class="token punctuation">:</span>
	      <span class="token key atrule">IMAGES_PATH</span><span class="token punctuation">:</span> <span class="token string">"$&#123;&#123; env.BASE_URL &#125;&#125;assets/img/"</span></code></pre>
<h2>Use a custom npm config</h2>
<p>This is very handly when you are working with private packages 📦</p>
<p>The idea is to store your PAT TOKEN for accessing your packages in your repository secrets and then use it on a custom npm config file.</p>
<blockquote><p>📝Note that we can just use the default <code>.npmrc</code> but it is a good idea to keep the npm config for your github actions separated.</p></blockquote>
<h3>How</h3>
<p>In order for it to work we need to:</p>
<ol><li>Create an npm config file 🦄<ul><li>includes the configuration for our private github packages</li>
<li>we will take the PAT TOKEN from an env variable</li>
<li>we can name it anything that we want</li>
<li>place it in the project root folder</li></ul></li>
<li>set our action to use our npm config file ✨</li>
<li>Generate a PAT TOKEN</li>
<li>Place the PAT TOKEN in our repository secrets</li></ol>
<p>Lets have a look at a case where we are using private github packages</p>
<ol><li><strong>Create the npm config file</strong></li></ol>
<p>Create a file named <code>.ci.npmrc</code> in the root folder of your project and place the following contents:</p>
<pre class="language-undefined"><code class="language-undefined">@your-scope:registry=https://npm.pkg.github.com
//npm.pkg.github.com/:_authToken=$&#123;NODE_AUTH_TOKEN&#125;</code></pre>
<blockquote><p>💡 Remember to replace “@your-scope” with your scope</p></blockquote>
<ol start="2"><li><strong>Set the action to use our custom npm config file</strong></li></ol>
<pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies ✨
  <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci
  <span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token key atrule">NPM_CONFIG_USERCONFIG</span><span class="token punctuation">:</span> .ci.npmrc
    <span class="token key atrule">NODE_AUTH_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.PAT_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>
<ol start="3"><li>Create your PAT TOKEN
Follow the <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token" rel="nofollow">instructions here</a>
When you are on the step 7 permissions and scopes:</li></ol>
<ul><li>make sure to select the “write:packages” option!</li>
<li>the “read:packages” is enabled as well
<img src="/images/blog/github-actions-tips-and-tricks/pat-creation.webp" alt="Github pat scopes"></li>
<li>Continue to the next steps and keep your PAT TOKEN ready!</li></ul>
<ol start="4"><li><strong>Place the PAT TOKEN to your repo secrets</strong>
Go to your repository on github:<ol><li>Click on “⚙️settings” tab</li>
<li>Select “Secrets”</li>
<li>Click on “New repository secret”</li>
<li>Set the “name” to be ”<strong>PAT_TOKEN</strong>”</li>
<li>Paste your token in the “value”</li>
<li>Select “Add secret”</li></ol></li></ol>
<p><img src="/images/blog/github-actions-tips-and-tricks/add-repo-secret.webp" alt="Github add secret"></p>
<h3>Summary 👨🏻‍💻</h3>
<p>We have explored ways to improve the performance of our github actions using caching.</p>
<p>Then we explored how we can create strings dynamically from env variables and finnaly we had a look in configuring our npm config for using private github packages in a secure and scalable way 😉.</p>
<p>Happy coding 😄 !!!</p></article></main>

<footer class="bg-gray-900 mt-8"><hr class="border-1 border-gray-600 w-full">

<p class="text-gray-400 py-3 text-xs text-center">© 2021 <b><a rel="noopener noreferrer" target="_blank" href="https://achimoraites.github.io">Achilles Moraites</a></b></p>
</footer>



	
</div>
	</body>
</html>
